# ç½‘æ˜“äº‘éŸ³ä¹æ— æŸè§£æ

<div align="center">

**åŠŸèƒ½å¼ºå¤§çš„ç½‘æ˜“äº‘éŸ³ä¹è§£æå·¥å…·**

æ”¯æŒæ­Œæ›²æœç´¢ | å•æ›²è§£æ | æ­Œå•è§£æ | ä¸“è¾‘è§£æ | éŸ³ä¹ä¸‹è½½

[åœ¨çº¿ä½“éªŒ](http://localhost:5001) â€¢ [é—®é¢˜åé¦ˆ](https://github.com/Awan/wan-music/issues)

</div>

---

> **âš ï¸ é‡è¦å£°æ˜**  
> æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯å¼€æºã€‚æ ¹æ® MIT è®¸å¯è¯çš„æ¡æ¬¾ï¼Œä»»ä½•ä¸ªäººæˆ–ç»„ç»‡å‡å¯è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘æœ¬é¡¹ç›®çš„æºä»£ç ï¼ŒåŒ…æ‹¬ç”¨äºå•†ä¸šé¡¹ç›®ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸµ æ ¸å¿ƒåŠŸèƒ½
- **ğŸ” æ­Œæ›²æœç´¢**ï¼šæ”¯æŒå…³é”®è¯æœç´¢ç½‘æ˜“äº‘éŸ³ä¹åº“ä¸­çš„æ­Œæ›²
- **ğŸ§ å•æ›²è§£æ**ï¼šè§£æå•é¦–æ­Œæ›²çš„è¯¦ç»†ä¿¡æ¯å’Œä¸‹è½½é“¾æ¥
- **ğŸ“‹ æ­Œå•è§£æ**ï¼šæ‰¹é‡è§£ææ­Œå•ä¸­çš„æ‰€æœ‰æ­Œæ›²ä¿¡æ¯
- **ğŸ’¿ ä¸“è¾‘è§£æ**ï¼šæ‰¹é‡è§£æä¸“è¾‘ä¸­çš„æ‰€æœ‰æ­Œæ›²ä¿¡æ¯
- **â¬‡ï¸ éŸ³ä¹ä¸‹è½½**ï¼šæ”¯æŒå¤šç§éŸ³è´¨çš„éŸ³ä¹æ–‡ä»¶ä¸‹è½½

### ğŸ¼ éŸ³è´¨æ”¯æŒ
| å‚æ•° | è¯´æ˜ |
|------|------|
| `standard` | æ ‡å‡†éŸ³è´¨ (128kbps) |
| `exhigh` | æé«˜éŸ³è´¨ (320kbps) |
| `lossless` | æ— æŸéŸ³è´¨ (FLAC) |
| `hires` | Hi-ReséŸ³è´¨ (24bit/96kHz) |
| `jyeffect` | é«˜æ¸…ç¯ç»•å£° |
| `sky` | æ²‰æµ¸ç¯ç»•å£° |
| `jymaster` | è¶…æ¸…æ¯å¸¦ |

> é»‘èƒ¶VIPéŸ³è´¨ï¼šstandard, exhigh, lossless, hires, jyeffect  
> é»‘èƒ¶SVIPéŸ³è´¨ï¼šsky, jymaster

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.9+
- ç½‘æ˜“äº‘éŸ³ä¹é»‘èƒ¶ä¼šå‘˜è´¦å·

### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/Awan/wan-music.git
cd wan-music

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. é…ç½®Cookie
# åœ¨ api/cookie.txt æ–‡ä»¶ä¸­å¡«å…¥é»‘èƒ¶ä¼šå‘˜è´¦å·çš„Cookie

# 4. å¯åŠ¨æœåŠ¡
python main.py

# 5. è®¿é—®ç•Œé¢
# æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5001
```

> ğŸ’¡ **è·å–Cookieæ–¹æ³•**ï¼šç™»å½•ç½‘æ˜“äº‘éŸ³ä¹ç½‘é¡µç‰ˆ â†’ F12å¼€å‘è€…å·¥å…· â†’ Networkæ ‡ç­¾é¡µ â†’ å¤åˆ¶ä»»æ„è¯·æ±‚çš„Cookieå€¼

### ğŸ³ Dockeréƒ¨ç½²

```bash
# ä½¿ç”¨Docker Compose
docker-compose up -d

# æˆ–ä½¿ç”¨Dockeræ„å»º
docker build -t wan-music .
docker run -d -p 5001:5001 wan-music
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### Webç•Œé¢ä½¿ç”¨

#### ğŸ” æ­Œæ›²æœç´¢
1. é€‰æ‹©åŠŸèƒ½ï¼š**æ­Œæ›²æœç´¢**
2. è¾“å…¥å…³é”®è¯ï¼ˆæ­Œæ›²åã€æ­Œæ‰‹åç­‰ï¼‰
3. ç‚¹å‡»**æœç´¢**æŒ‰é’®
4. åœ¨æœç´¢ç»“æœä¸­ç‚¹å‡»**è§£æ**æˆ–**ä¸‹è½½**æŒ‰é’®

#### ğŸ§ å•æ›²è§£æ
1. é€‰æ‹©åŠŸèƒ½ï¼š**å•æ›²è§£æ**
2. è¾“å…¥æ­Œæ›²IDæˆ–ç½‘æ˜“äº‘éŸ³ä¹é“¾æ¥
   - æ”¯æŒæ ¼å¼ï¼š`1234567890` æˆ– `https://music.163.com/song?id=1234567890`
3. ç‚¹å‡»**è§£æ**æŒ‰é’®æŸ¥çœ‹æ­Œæ›²ä¿¡æ¯

#### ğŸ“‹ æ­Œå•è§£æ
1. é€‰æ‹©åŠŸèƒ½ï¼š**æ­Œå•è§£æ**
2. è¾“å…¥æ­Œå•IDæˆ–ç½‘æ˜“äº‘éŸ³ä¹æ­Œå•é“¾æ¥
   - æ”¯æŒæ ¼å¼ï¼š`1234567890` æˆ– `https://music.163.com/playlist?id=1234567890`
3. ç‚¹å‡»**è§£æ**æŒ‰é’®æŸ¥çœ‹æ­Œå•ä¸­æ‰€æœ‰æ­Œæ›²
4. ç‚¹å‡»å•é¦–æ­Œæ›²çš„**è§£æ**æˆ–**ä¸‹è½½**æŒ‰é’®

#### ğŸ’¿ ä¸“è¾‘è§£æ
1. é€‰æ‹©åŠŸèƒ½ï¼š**ä¸“è¾‘è§£æ**
2. è¾“å…¥ä¸“è¾‘IDæˆ–ç½‘æ˜“äº‘éŸ³ä¹ä¸“è¾‘é“¾æ¥
   - æ”¯æŒæ ¼å¼ï¼š`1234567890` æˆ– `https://music.163.com/album?id=1234567890`
3. ç‚¹å‡»**è§£æ**æŒ‰é’®æŸ¥çœ‹ä¸“è¾‘ä¸­æ‰€æœ‰æ­Œæ›²
4. ç‚¹å‡»å•é¦–æ­Œæ›²çš„**è§£æ**æˆ–**ä¸‹è½½**æŒ‰é’®

#### â¬‡ï¸ éŸ³ä¹ä¸‹è½½
1. é€‰æ‹©åŠŸèƒ½ï¼š**éŸ³ä¹ä¸‹è½½**
2. è¾“å…¥æ­Œæ›²IDæˆ–é“¾æ¥
3. é€‰æ‹©éŸ³è´¨ï¼ˆæ ‡å‡†/æé«˜/æ— æŸ/Hi-Resç­‰ï¼‰
4. ç‚¹å‡»**ä¸‹è½½**æŒ‰é’®

### æ”¯æŒçš„é“¾æ¥æ ¼å¼

```bash
# æ­Œæ›²é“¾æ¥
https://music.163.com/song?id=1234567890
https://music.163.com/#/song?id=1234567890

# æ­Œå•é“¾æ¥
https://music.163.com/playlist?id=1234567890
https://music.163.com/#/playlist?id=1234567890

# ä¸“è¾‘é“¾æ¥
https://music.163.com/album?id=1234567890
https://music.163.com/#/album?id=1234567890

# ç›´æ¥ä½¿ç”¨ID
1234567890
```

---

## ğŸ”Œ APIæ¥å£æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯
- **Base URL**: `http://localhost:5001`
- **è¯·æ±‚æ–¹å¼**: GET / POST
- **å“åº”æ ¼å¼**: JSON

### æ¥å£åˆ—è¡¨

#### 1. å¥åº·æ£€æŸ¥
```http
GET /health
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "ok",
  "message": "Service is running"
}
```

#### 2. æ­Œæ›²æœç´¢
```http
POST /search
Content-Type: application/json

{
  "keywords": "å‘¨æ°ä¼¦ ç¨»é¦™",
  "limit": 10
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "result": {
    "songs": [...]
  }
}
```

#### 3. å•æ›²è§£æ
```http
POST /song
Content-Type: application/json

{
  "id": "185668"
}
```

#### 4. æ­Œå•è§£æ
```http
POST /playlist
Content-Type: application/json

{
  "id": "123456789"
}
```

#### 5. ä¸“è¾‘è§£æ
```http
POST /album
Content-Type: application/json

{
  "id": "123456789"
}
```

#### 6. éŸ³ä¹ä¸‹è½½
```http
POST /download
Content-Type: application/json

{
  "id": "185668",
  "quality": "lossless"
}
```

**å“åº”**: ç›´æ¥è¿”å›éŸ³é¢‘æ–‡ä»¶æµ

---

## âš™ï¸ é…ç½®è¯´æ˜

### Cookieé…ç½®

åœ¨ `api/cookie.txt` æ–‡ä»¶ä¸­é…ç½®ç½‘æ˜“äº‘éŸ³ä¹Cookieï¼š

```text
MUSIC_U=ä½ çš„MUSIC_Uå€¼; os=pc; appver=8.9.70;
```

> âš ï¸ **é‡è¦æç¤º**ï¼š
> - å¿…é¡»ä½¿ç”¨é»‘èƒ¶ä¼šå‘˜è´¦å·çš„Cookie
> - Cookieæ ¼å¼å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ç¤ºä¾‹å¡«å†™
> - å®šæœŸæ›´æ–°Cookieä»¥ä¿æŒæœ‰æ•ˆæ€§

### ç¯å¢ƒå˜é‡

å¯ä»¥é€šè¿‡ `.env` æ–‡ä»¶é…ç½®æœåŠ¡ï¼š

```bash
HOST=0.0.0.0
PORT=5001
DEBUG=false
LOG_LEVEL=INFO
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Cookieæ— æ•ˆ
**é—®é¢˜**ï¼šæç¤ºCookieæ— æ•ˆæˆ–è¿‡æœŸ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤ä½¿ç”¨çš„æ˜¯é»‘èƒ¶ä¼šå‘˜è´¦å·
- é‡æ–°è·å–Cookieå¹¶æ›´æ–° `api/cookie.txt`
- æ£€æŸ¥Cookieæ ¼å¼æ˜¯å¦æ­£ç¡®

#### 2. æ— æ³•ä¸‹è½½é«˜éŸ³è´¨
**é—®é¢˜**ï¼šåªèƒ½ä¸‹è½½æ ‡å‡†éŸ³è´¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤è´¦å·æ˜¯é»‘èƒ¶ä¼šå‘˜
- æ£€æŸ¥Cookieæ˜¯å¦æœ‰æ•ˆ
- ç¡®è®¤æ­Œæ›²æœ¬èº«æ”¯æŒé«˜éŸ³è´¨

#### 3. æœåŠ¡å¯åŠ¨å¤±è´¥
**é—®é¢˜**ï¼šè¿è¡Œ `python main.py` æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥Pythonç‰ˆæœ¬ï¼ˆéœ€è¦3.9+ï¼‰
- å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š`pip install -r requirements.txt`
- æ£€æŸ¥ç«¯å£5001æ˜¯å¦è¢«å ç”¨

#### 4. ä¸‹è½½æ–‡ä»¶æŸå
**é—®é¢˜**ï¼šä¸‹è½½çš„éŸ³é¢‘æ–‡ä»¶æ— æ³•æ’­æ”¾

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®š
- é‡æ–°ä¸‹è½½æ–‡ä»¶
- å°è¯•å…¶ä»–éŸ³è´¨é€‰é¡¹

### æ—¥å¿—æŸ¥çœ‹

æœåŠ¡è¿è¡Œæ—¶ä¼šç”Ÿæˆæ—¥å¿—æ–‡ä»¶ `music_api.log`ï¼š

```bash
tail -f music_api.log
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
wan-music/
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ Dockerfile              # Dockeræ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml      # Docker Composeé…ç½®
â”œâ”€â”€ .env                    # ç¯å¢ƒé…ç½®
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ docker-publish.yml  # GitHub Actions
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ main.py             # Flaskä¸»ç¨‹åº
â”‚   â”œâ”€â”€ music_api.py        # éŸ³ä¹APIæ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ music_downloader.py # éŸ³ä¹ä¸‹è½½æ¨¡å—
â”‚   â”œâ”€â”€ cookie_manager.py   # Cookieç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ qr_login.py         # äºŒç»´ç ç™»å½•æ¨¡å—
â”‚   â”œâ”€â”€ api_security.py     # APIå®‰å…¨æ¨¡å—
â”‚   â””â”€â”€ cookie.txt          # Cookieé…ç½®
â””â”€â”€ frontend/
    â”œâ”€â”€ index.html          # Webç•Œé¢
    â”œâ”€â”€ css/                # æ ·å¼æ–‡ä»¶
    â”œâ”€â”€ js/                 # è„šæœ¬æ–‡ä»¶
    â””â”€â”€ imgs/               # å›¾ç‰‡èµ„æº
```

### æŠ€æœ¯æ ˆ

- **åç«¯**ï¼šFlask + Python
- **å‰ç«¯**ï¼šBootstrap + jQuery
- **éŸ³é¢‘å¤„ç†**ï¼šmutagen, FLACMetadata, ID3Writer
- **HTTPå®¢æˆ·ç«¯**ï¼šaiohttp + requests
- **å®¹å™¨åŒ–**ï¼šDocker + GitHub Actions

---

## ğŸ¤– CI/CD

### GitHub Actions

æ¨é€ç‰ˆæœ¬æ ‡ç­¾è‡ªåŠ¨æ„å»ºå¹¶æ¨é€åˆ° Docker Hubï¼š

```bash
git tag v1.0.0
git push origin v1.0.0
```

è¿™å°†æ„å»ºå¹¶æ¨é€ `awan1987/wan-music:1.0.0` åˆ° Docker Hubã€‚

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯å¼€æºã€‚

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. æäº¤ Pull Request

---

## ğŸ“ è”ç³»æ–¹å¼

- **GitHub Issues**ï¼š[æäº¤é—®é¢˜](https://github.com/Awan/wan-music/issues)

---

æ¬¢è¿ Starã€Fork å’Œ PRï¼
